{"version":3,"file":"data-hub.common.js","sources":["../src/util/invariant.js","../src/rxjs.js","../src/store.js","../src/hub.js","../src/tool/vue.js","../src/middleware/log.js","../src/tool/react.js"],"sourcesContent":["let NODE_ENV = process.env.NODE_ENV;\n\nexport default function(condition, format, a, b, c, d, e, f) {\n  if (NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    let error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      let args = [a, b, c, d, e, f];\n      let argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n}\n","import invariant from './util/invariant';\n\nexport let Rx = {\n  _needInstall: true\n};\n\nexport function useRx(_Rx={}) {\n  Rx = _Rx;\n} \n\nexport function checkRx() {\n  invariant(\n    !Rx._needInstall && Rx.Observable && Rx.Subject,\n    `data-hub error ~ useRx({Observerble, Subject}) is required!`\n  );\n\n  invariant(\n    Rx.Observable.from,\n    `data-hub error ~ 'Rx.Observable.from' is required! Try import 'rxjs/add/observable/from'`\n  );\n\n  invariant(\n    Rx.Observable.of,\n    `data-hub error ~ 'Rx.Observable.of' is required! Try import 'rxjs/add/observable/of'`\n  );\n}","import {Rx, checkRx} from './rxjs';\nimport invariant from './util/invariant';\n\nexport default class Store {\n\n  // constructor\n  constructor(options={}) {\n    checkRx();\n\n    this._check(options);\n\n    this.debug = !!options.debug;\n    this.name = options.name || 'data-hub store';\n    this._isRxHubStore = true;\n    this._subject = new Rx.Subject();\n    this._state = options.initialState || {};\n    this._mutations = options.mutations || {};\n    this._modules = options.modules || {};\n  }\n\n  _check(options) {\n    invariant(\n      typeof options === 'object',\n      `data-hub error ~ store: options is not an object!`\n    );\n\n    let initialState = options.initialState || {};\n    invariant(\n      initialState && typeof initialState === 'object',\n      `data-hub error ~ store: options.initialState is not an object!`\n    );\n\n    let mutations = options.mutations || {};\n    invariant(\n      mutations && typeof mutations === 'object',\n      `data-hub error ~ store: options.mutations is not an object!`\n    )\n\n    let modules = options.modules || {};\n    invariant(\n      modules && typeof modules === 'object',\n      `data-hub error ~ store: options.modules is not an object!`\n    );\n\n    Object.keys(modules).forEach(key => {\n      let module = modules[key];\n      invariant(\n        typeof module === 'object' && module._isRxHubStore,\n        `data-hub error ~ store: module must be a store instance!`\n      );\n    });\n  }\n\n  // subscribe\n  subscribe(...args) {\n    return this._subject.subscribe(...args);\n  }\n\n  // state\n  get state() {\n    return this.getState();\n  }\n\n  // get store's state\n  getState() {\n    let state = this._state;\n\n    Object.keys(this._modules).forEach(moduleName => {\n      state[moduleName] = this._modules[moduleName].getState();\n    });\n\n    return state;\n  }\n\n  /**\n   * clone a node in state, internal use: JSON.parse(JSON.stringify(node))\n   * let userList = store.copy('user.list');\n   */\n  copy(path) {\n    let arr = path ? path.split('.') : [];\n    let find = this.state;\n\n    while (typeof find === 'object' && arr.length) {\n      find = find[arr.shift()];\n    }\n\n    return JSON.parse(JSON.stringify(find));\n  }\n\n  /**\n   * [commit description]\n   * store.commit('main.user.add', {username: ''})\n   */\n  commit(mutation, payload, parent='') {\n    let arr = mutation.split('.', 2);\n    let location = parent ? parent + '.' + arr[0] : arr[0];\n\n    // log\n    if (this.debug && !parent) {\n      console.log(`data-hub log ~ store commit <${mutation}>`, payload);\n    }\n\n    // module\n    if (arr.length > 1) {\n      let moduleName = arr[0];\n      let module = this._modules[moduleName];\n\n      invariant(\n        module,\n        `data-hub error ~ store: module <${location}> is not defined!`\n      );\n\n      module.commit(arr[1], payload, location);\n\n      // let observer know\n      this._subject.next(this.getState());\n\n      return;\n    }\n\n    // mutation\n    invariant(\n      this._mutations[mutation],\n      `data-hub error ~ store: mutation <${location}> is not defined!`\n    )\n\n    let mutationFunc = this._mutations[mutation].bind(this);\n    mutationFunc(payload, this._state, this);\n\n    // let observer know\n    this._subject.next(this.getState());\n  }\n\n  // store is also a observer\n  next({mutation, payload}) {\n    this.commit(mutation, payload);\n  }\n\n  error() {\n    //\n  }\n\n  complete() {\n    //\n  }\n}\n","import {Rx, checkRx} from './rxjs';\nimport invariant from './util/invariant';\n\nexport default class Hub {\n  // constructor\n  constructor(options={}) {\n    // check rx install\n    checkRx();\n\n    let beforeMiddlewares = options.beforeMiddlewares || [];\n    let afterMiddlewares = options.afterMiddlewares || [];\n\n    // Rx Refrence\n    this.Rx = Rx;\n\n    // store pipes, middlewares\n    this._pipes = {};\n    this._middlewares = {\n      before: beforeMiddlewares,\n      after: afterMiddlewares,\n    };\n\n    // combinedMiddleware\n    this.combinedMiddleware = this.combinedMiddleware.bind(this);\n  }\n\n  // get pipe\n  pipe(name) {\n    invariant(\n      typeof this._pipes[name] === 'function',\n      `data-hub error ~ pipe <${name}> is undefined or not function!`\n    );\n    return this._pipes[name];\n  }\n\n  // add pipe\n  addPipe(name, converter) {\n    let converterFn = (payload) => {\n      let ob = converter(payload);\n      return Rx.Observable.from(ob);\n    }\n    \n    this._pipes[name] = (payload) => {\n      return Rx.Observable.of(payload)\n        .concatMap(this.combinedMiddleware('before', name))\n        .concatMap(converterFn)\n        .concatMap(this.combinedMiddleware('after', name));\n    }\n  }\n\n  // add pipes\n  addPipes(context, converters) {\n    Object.keys(converters).forEach(key => {\n      let converter = converters[key];\n      let pipeName = context + '.' + key;\n      this.addPipe(pipeName, converter);\n    });\n  }\n\n  // commine middlewares\n  combinedMiddleware(type, pipeName) {\n    return (payload) => {\n      let observable = Rx.Observable.of(payload);\n      this._middlewares[type].forEach(fn => {\n        observable = observable.map(payload => {\n          return {\n            payload,\n            pipeName,\n            type,\n          };\n        }).concatMap(fn);\n      });\n      return observable;\n    }\n  }\n\n  // add middleware\n  addMiddleware(type, middleware) {\n    let middlewareFn = (payload) => {\n      let ob = middleware(payload);\n      return Rx.Observable.from(ob);\n    }\n\n    this._middlewares[type].push(middlewareFn);\n  }\n}\n","import {Rx, checkRx} from '../rxjs';\nconst VuePlugin = {};\n\nVuePlugin.install = function(Vue, options={}) {\n  // check rx install\n  checkRx();\n\n  let storeOptionKey = options.storeOptionKey || 'store';\n  let storeKey = options.storeKey || '$store';\n  let hubOptionKey = options.hubOptionKey || 'hub';\n  let hubKey = options.hubKey || '$hub';\n  let stateKey = options.stateKey || '$state';\n  let subscriptionsKey = options.subscriptionsKey || '$subs';\n\n  Vue.prototype.$unsubscribe = function(ns) {\n    const vm = this;\n    const subs = vm[subscriptionsKey];\n\n    try {\n      // unsubscribe one\n      if (ns) {\n        let sub = subs[ns]; \n        if (sub && typeof sub.unsubscribe === 'function') {\n          sub.unsubscribe();\n        }\n        delete subs[ns];\n        return;\n      }\n\n      // unsubscribe all\n      Object.keys(subs).forEach(key => {\n        let sub = subs[key];\n        if (sub && typeof sub.unsubscribe === 'function') {\n          sub.unsubscribe();\n        }\n        delete subs[key];\n      });\n    } catch(e) {\n      console.log(e);\n    }\n  }\n\n  // mixin\n  Vue.mixin({\n\n    beforeCreate() {\n      const vm = this;\n      const options = vm.$options;\n      const store = options[storeOptionKey];\n      const hub = options[hubOptionKey];\n\n      // subscriptions\n      vm[subscriptionsKey] = {};\n\n      // store injection\n      if (store) {\n        vm[storeKey] = typeof store === 'function' ? store() : store;\n        vm[stateKey] = ( new Vue({ data: vm[storeKey].state }) ).$data;\n      } else if (options.parent && options.parent[storeKey]) {\n        vm[storeKey] = options.parent[storeKey];\n        vm[stateKey] = options.parent[stateKey];\n      }\n\n      // hub injection\n      if (hub) {\n        vm[hubKey] = typeof hub === 'function' ? hub() : hub;\n      } else if (options.parent && options.parent[hubKey]) {\n        vm[hubKey] = options.parent[hubKey];\n      }\n\n      // subjects\n      let subjects = options['subjects'] || [];\n      subjects.forEach(sName => {\n        vm[sName] = new Rx.Subject();\n      });\n    },\n\n    beforeDestroy() {\n      this.$unsubscribe();\n    }\n  });\n}\n\nexport default VuePlugin;\n","import {Rx} from '../rxjs';;\n\nexport default function logMiddleware({payload, pipeName, type}) {\n  let data = payload;\n  let typeMsg = {\n    before: 'in',\n    after: 'out'\n  }[type];\n\n  try {\n    let data = JSON.parse(JSON.stringify(payload));\n  } catch(e) {\n    //\n  }\n\n  console.log(`data-hub log ~ pipe ${typeMsg} <${pipeName}>:`, data);\n\n  return Rx.Observable.of(payload);\n}\n","import {Rx, checkRx} from '../rxjs';\n\nexport default function createRxHubComponent({\n  store,\n  hub,\n  storeKey = '$store',\n  hubKey = '$hub',\n  subscriptionsKey = '$subs'\n}, React) {\n\n  class RxHubComponent extends React.Component {\n    constructor(props) {\n      super(props);\n\n      // check rx install\n      checkRx();\n\n      this[storeKey] = store;\n      this[hubKey] = hub;\n      this[subscriptionsKey] = {};      \n    }\n\n    $unsubscribe(ns) {\n      const vm = this;\n      const subs = vm[subscriptionsKey];\n  \n      try {\n        // unsubscribe one\n        if (ns) {\n          let sub = subs[ns]; \n          if (sub && typeof sub.unsubscribe === 'function') {\n            sub.unsubscribe();\n          }\n          delete subs[ns];\n          return;\n        }\n  \n        // unsubscribe all\n        Object.keys(subs).forEach(key => {\n          let sub = subs[key];\n          if (sub && typeof sub.unsubscribe === 'function') {\n            sub.unsubscribe();\n          }\n          delete subs[key];\n        });\n      } catch(e) {\n        console.log(e);\n      }\n    }\n\n    componentWillUnMount() {\n      this.$unsubscribe();\n    }\n  };\n\n  return RxHubComponent;\n}\n"],"names":["NODE_ENV","process","env","condition","format","a","b","c","d","e","f","undefined","Error","error","args","argIndex","replace","name","framesToPop","Rx","useRx","_Rx","checkRx","_needInstall","Observable","Subject","from","of","Store","options","_check","debug","_isRxHubStore","_subject","_state","initialState","_mutations","mutations","_modules","modules","keys","forEach","module","key","subscribe","state","moduleName","getState","path","arr","split","find","length","shift","JSON","parse","stringify","mutation","payload","parent","location","log","commit","next","mutationFunc","bind","Hub","beforeMiddlewares","afterMiddlewares","_pipes","_middlewares","combinedMiddleware","converter","converterFn","ob","concatMap","context","converters","pipeName","addPipe","type","observable","map","fn","middleware","middlewareFn","push","VuePlugin","install","Vue","storeOptionKey","storeKey","hubOptionKey","hubKey","stateKey","subscriptionsKey","prototype","$unsubscribe","ns","vm","subs","sub","unsubscribe","mixin","$options","store","hub","data","$data","subjects","sName","logMiddleware","typeMsg","createRxHubComponent","React","RxHubComponent","props","Component"],"mappings":"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"}